# @package _global_
# File name: nts_linear_synthetic.yaml
#   nts = number of time steps
#   linear = LinearNN model
#   synthetic = synthetic datasets (Sines, Lorenz, VanDerPol, RandWalk, WhiteNoise)
# We increase gradually the quantity of worms from all datasets.
# We choose the hidden size to get a model with ~0.574M (trainable) parameters.
defaults:
  - override /submodule: [model, train, visualize]
  - _self_

hydra:
  mode: MULTIRUN
  sweeper:
    params:
      experiment.seed: 4 # assign each repetition of the experiment a distinct random seed
      submodule.dataset.experimental_datasets: choice({VanDerPol0000:4},{VanDerPol0000:8},{VanDerPol0000:12},{VanDerPol0000:16},{VanDerPol0000:20},{VanDerPol0000:24},{VanDerPol0000:28},{VanDerPol0000:32},{VanDerPol0000:36},{VanDerPol0000:40},{VanDerPol0000:44},{VanDerPol0000:48},{VanDerPol0000:52},{VanDerPol0000:56},{VanDerPol0000:60},{VanDerPol0000:64},{VanDerPol0000:68},{VanDerPol0000:72},{VanDerPol0000:76},{VanDerPol0000:80},{VanDerPol0000:84},{VanDerPol0000:88},{VanDerPol0000:92},{VanDerPol0000:96},{VanDerPol0000:100})
      ### Synthetic datasets ###
      # seed 0: choice({Sines0000:6},{Sines0000:12},{Sines0000:18},{Sines0000:24},{Sines0000:30},{Sines0000:36},{Sines0000:42},{Sines0000:48},{Sines0000:54},{Sines0000:60},{Sines0000:66},{Sines0000:72},{Sines0000:78},{Sines0000:84},{Sines0000:90},{Sines0000:96})
      # seed 1: choice({Lorenz0000:7},{Lorenz0000:14},{Lorenz0000:21},{Lorenz0000:28},{Lorenz0000:35},{Lorenz0000:42},{Lorenz0000:49},{Lorenz0000:56},{Lorenz0000:63},{Lorenz0000:70},{Lorenz0000:77},{Lorenz0000:84},{Lorenz0000:91},{Lorenz0000:98})
      # seed 2: choice({WhiteNoise0000:6},{WhiteNoise0000:12},{WhiteNoise0000:18},{WhiteNoise0000:24},{WhiteNoise0000:30},{WhiteNoise0000:36},{WhiteNoise0000:42},{WhiteNoise0000:48},{WhiteNoise0000:54},{WhiteNoise0000:60},{WhiteNoise0000:66},{WhiteNoise0000:72},{WhiteNoise0000:78},{WhiteNoise0000:84},{WhiteNoise0000:90},{WhiteNoise0000:96})
      # seed 3: choice({RandWalk0000:5},{RandWalk0000:10},{RandWalk0000:15},{RandWalk0000:20},{RandWalk0000:25},{RandWalk0000:30},{RandWalk0000:35},{RandWalk0000:40},{RandWalk0000:45},{RandWalk0000:50},{RandWalk0000:55},{RandWalk0000:60},{RandWalk0000:65},{RandWalk0000:70},{RandWalk0000:75},{RandWalk0000:80},{RandWalk0000:85},{RandWalk0000:90},{RandWalk0000:95},{RandWalk0000:100})
      # seed 4: choice({VanDerPol0000:4},{VanDerPol0000:8},{VanDerPol0000:12},{VanDerPol0000:16},{VanDerPol0000:20},{VanDerPol0000:24},{VanDerPol0000:28},{VanDerPol0000:32},{VanDerPol0000:36},{VanDerPol0000:40},{VanDerPol0000:44},{VanDerPol0000:48},{VanDerPol0000:52},{VanDerPol0000:56},{VanDerPol0000:60},{VanDerPol0000:64},{VanDerPol0000:68},{VanDerPol0000:72},{VanDerPol0000:76},{VanDerPol0000:80},{VanDerPol0000:84},{VanDerPol0000:88},{VanDerPol0000:92},{VanDerPol0000:96},{VanDerPol0000:100}) 

submodule:

  model:
    # Build model from scratch
    type: LinearNN 
    hidden_size: 512

  train:
    # Train model
    epochs: 500

  dataset:
    # Set path to a directory with a fixed validation set for the current synthetic dataset
    use_these_datasets:
      # path: /om2/user/qsimeon/worm-graph/data/sines_validation 
      # path: /om2/user/qsimeon/worm-graph/data/lorenz_validation 
      # path: /om2/user/qsimeon/worm-graph/data/whitenoise_validation 
      # path: /om2/user/qsimeon/worm-graph/data/randwalk_validation 
      path: /om2/user/qsimeon/worm-graph/data/vanderpol_validation 
      num_worms: null

    save_datasets: false

    experimental_datasets:
      # This gets overwritten by the sweeper
      Sines0000: null
      Lorenz0000: null
      WhiteNoise0000: null
      RandWalk0000: null
      VanDerPol0000: null

    num_named_neurons: null
    num_train_samples: 32
    num_val_samples: 16
    seq_len: 100
    reverse: false
    use_residual: false
    smooth_data: true

  predict:
    # Choose the worms that you want to predict
    experimental_datasets:
      Sines0000: [worm0, worm1] # test to check if distinct neuron signatures preserved across worms
      Lorenz0000: worm0
      WhiteNoise0000: worm0
      RandWalk0000: worm0
      VanDerPol0000: worm0
    # Number of time steps to generate
    nb_ts_to_generate: null
    context_window: 100

  analysis:
    analyse_this_log_dir: null
    # Validate final model using some worms from each synthetic dataset
    validation:
      experimental_datasets:
        Sines0000: 10
        Lorenz0000: 10
        WhiteNoise0000: 10
        RandWalk0000: 10
        VanDerPol0000: 10

experiment: 
  # What parameter you are experimenting with (key)
  key: num_time_steps 
  name: nts_linear_synthetic
  mode: MULTIRUN