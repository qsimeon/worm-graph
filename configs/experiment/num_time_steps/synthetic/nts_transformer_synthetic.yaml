# @package _global_
# File name: nts_transformer_synthetic.yaml
#   nts = number of time steps (key: num_time_steps)
#   transformer = NeuralTransformer model
#   synthetic = synthetic datasets (Sines, Lorenz, VanDerPol, RandWalk, WhiteNoise)
# We increase gradually the quantity of worms from all datasets.
# We choose the hidden size to get a model with ~0.574M (trainable) parameters.
defaults:
  - override /submodule: [model, train, visualize]
  - _self_

hydra:
  mode: MULTIRUN
  sweeper:
    params:
      experiment.seed: 3 # assign each repetition of the experiment a distinct random seed
      submodule.dataset.use_these_datasets.path: choice(/om2/user/qsimeon/worm-graph/data/validation_RandWalk0000)
      submodule.dataset.experimental_datasets: choice({RandWalk0000:1},{RandWalk0000:2},{RandWalk0000:3},{RandWalk0000:4},{RandWalk0000:5},{RandWalk0000:6},{RandWalk0000:7},{RandWalk0000:8},{RandWalk0000:9},{RandWalk0000:10},{RandWalk0000:11},{RandWalk0000:12},{RandWalk0000:13},{RandWalk0000:14},{RandWalk0000:15},{RandWalk0000:16},{RandWalk0000:17},{RandWalk0000:18},{RandWalk0000:19},{RandWalk0000:20},{RandWalk0000:21},{RandWalk0000:22},{RandWalk0000:23},{RandWalk0000:24},{RandWalk0000:25},{RandWalk0000:26},{RandWalk0000:27},{RandWalk0000:28},{RandWalk0000:29},{RandWalk0000:30},{RandWalk0000:31},{RandWalk0000:32},{RandWalk0000:33},{RandWalk0000:34},{RandWalk0000:35},{RandWalk0000:36},{RandWalk0000:37},{RandWalk0000:38},{RandWalk0000:39},{RandWalk0000:40},{RandWalk0000:41},{RandWalk0000:42},{RandWalk0000:43},{RandWalk0000:44},{RandWalk0000:45},{RandWalk0000:46},{RandWalk0000:47},{RandWalk0000:48},{RandWalk0000:49},{RandWalk0000:50},{RandWalk0000:51},{RandWalk0000:52},{RandWalk0000:53},{RandWalk0000:54},{RandWalk0000:55},{RandWalk0000:56},{RandWalk0000:57},{RandWalk0000:58},{RandWalk0000:59},{RandWalk0000:60},{RandWalk0000:61},{RandWalk0000:62},{RandWalk0000:63},{RandWalk0000:64},{RandWalk0000:65},{RandWalk0000:66},{RandWalk0000:67},{RandWalk0000:68},{RandWalk0000:69},{RandWalk0000:70},{RandWalk0000:71},{RandWalk0000:72},{RandWalk0000:73},{RandWalk0000:74},{RandWalk0000:75},{RandWalk0000:76},{RandWalk0000:77},{RandWalk0000:78},{RandWalk0000:79},{RandWalk0000:80},{RandWalk0000:81},{RandWalk0000:82},{RandWalk0000:83},{RandWalk0000:84},{RandWalk0000:85},{RandWalk0000:86},{RandWalk0000:87},{RandWalk0000:88},{RandWalk0000:89},{RandWalk0000:90},{RandWalk0000:91},{RandWalk0000:92},{RandWalk0000:93},{RandWalk0000:94},{RandWalk0000:95},{RandWalk0000:96},{RandWalk0000:97},{RandWalk0000:98},{RandWalk0000:99},{RandWalk0000:100})
      submodule.predict.experimental_datasets: choice({RandWalk0000:worm0})
      submodule.analysis.validation.experimental_datasets: choice({RandWalk0000:all})
      ### submodule.dataset.use_these_datasets.path ###
      # seed 0: choice(/om2/user/qsimeon/worm-graph/data/validation_Sines0000)
      # seed 1: choice(/om2/user/qsimeon/worm-graph/data/validation_Lorenz0000)
      # seed 2: choice(/om2/user/qsimeon/worm-graph/data/validation_WhiteNoise0000)
      # seed 3: choice(/om2/user/qsimeon/worm-graph/data/validation_RandWalk0000)
      # seed 4: choice(/om2/user/qsimeon/worm-graph/data/validation_VanDerPol0000)
      ### submodule.dataset.experimental_datasets ###
      # seed 0: choice({Sines0000:3},{Sines0000:6},{Sines0000:9},{Sines0000:12},{Sines0000:15},{Sines0000:18},{Sines0000:21},{Sines0000:24},{Sines0000:27},{Sines0000:30},{Sines0000:33},{Sines0000:36},{Sines0000:39},{Sines0000:42},{Sines0000:45},{Sines0000:48},{Sines0000:51},{Sines0000:54},{Sines0000:57},{Sines0000:60},{Sines0000:63},{Sines0000:66},{Sines0000:69},{Sines0000:72},{Sines0000:75},{Sines0000:78},{Sines0000:81},{Sines0000:84},{Sines0000:87},{Sines0000:90},{Sines0000:93},{Sines0000:96},{Sines0000:99})
      # seed 1: choice({Lorenz0000:3},{Lorenz0000:6},{Lorenz0000:9},{Lorenz0000:12},{Lorenz0000:15},{Lorenz0000:18},{Lorenz0000:21},{Lorenz0000:24},{Lorenz0000:27},{Lorenz0000:30},{Lorenz0000:33},{Lorenz0000:36},{Lorenz0000:39},{Lorenz0000:42},{Lorenz0000:45},{Lorenz0000:48},{Lorenz0000:51},{Lorenz0000:54},{Lorenz0000:57},{Lorenz0000:60},{Lorenz0000:63},{Lorenz0000:66},{Lorenz0000:69},{Lorenz0000:72},{Lorenz0000:75},{Lorenz0000:78},{Lorenz0000:81},{Lorenz0000:84},{Lorenz0000:87},{Lorenz0000:90},{Lorenz0000:93},{Lorenz0000:96},{Lorenz0000:99})
      # seed 2: choice({WhiteNoise0000:3},{WhiteNoise0000:6},{WhiteNoise0000:9},{WhiteNoise0000:12},{WhiteNoise0000:15},{WhiteNoise0000:18},{WhiteNoise0000:21},{WhiteNoise0000:24},{WhiteNoise0000:27},{WhiteNoise0000:30},{WhiteNoise0000:33},{WhiteNoise0000:36},{WhiteNoise0000:39},{WhiteNoise0000:42},{WhiteNoise0000:45},{WhiteNoise0000:48},{WhiteNoise0000:51},{WhiteNoise0000:54},{WhiteNoise0000:57},{WhiteNoise0000:60},{WhiteNoise0000:63},{WhiteNoise0000:66},{WhiteNoise0000:69},{WhiteNoise0000:72},{WhiteNoise0000:75},{WhiteNoise0000:78},{WhiteNoise0000:81},{WhiteNoise0000:84},{WhiteNoise0000:87},{WhiteNoise0000:90},{WhiteNoise0000:93},{WhiteNoise0000:96},{WhiteNoise0000:99})
      # seed 3: choice({RandWalk0000:3},{RandWalk0000:6},{RandWalk0000:9},{RandWalk0000:12},{RandWalk0000:15},{RandWalk0000:18},{RandWalk0000:21},{RandWalk0000:24},{RandWalk0000:27},{RandWalk0000:30},{RandWalk0000:33},{RandWalk0000:36},{RandWalk0000:39},{RandWalk0000:42},{RandWalk0000:45},{RandWalk0000:48},{RandWalk0000:51},{RandWalk0000:54},{RandWalk0000:57},{RandWalk0000:60},{RandWalk0000:63},{RandWalk0000:66},{RandWalk0000:69},{RandWalk0000:72},{RandWalk0000:75},{RandWalk0000:78},{RandWalk0000:81},{RandWalk0000:84},{RandWalk0000:87},{RandWalk0000:90},{RandWalk0000:93},{RandWalk0000:96},{RandWalk0000:99})
      # seed 4: choice({VanDerPol0000:3},{VanDerPol0000:6},{VanDerPol0000:9},{VanDerPol0000:12},{VanDerPol0000:15},{VanDerPol0000:18},{VanDerPol0000:21},{VanDerPol0000:24},{VanDerPol0000:27},{VanDerPol0000:30},{VanDerPol0000:33},{VanDerPol0000:36},{VanDerPol0000:39},{VanDerPol0000:42},{VanDerPol0000:45},{VanDerPol0000:48},{VanDerPol0000:51},{VanDerPol0000:54},{VanDerPol0000:57},{VanDerPol0000:60},{VanDerPol0000:63},{VanDerPol0000:66},{VanDerPol0000:69},{VanDerPol0000:72},{VanDerPol0000:75},{VanDerPol0000:78},{VanDerPol0000:81},{VanDerPol0000:84},{VanDerPol0000:87},{VanDerPol0000:90},{VanDerPol0000:93},{VanDerPol0000:96},{VanDerPol0000:99}) 
      ### submodule.predict.experimental_datasets ###
      # seed 0: choice({Sines0000:[worm0, worm1]})
      # seed 1: choice({Lorenz0000:worm0})
      # seed 2: choice({WhiteNoise0000:worm0})
      # seed 3: choice({RandWalk0000:worm0})
      # seed 4: choice({VanDerPol0000:worm0})
      ### submodule.analysis.validation.experimental_datasets ###
      # seed 0: choice({Sines0000:all})
      # seed 1: choice({Lorenz0000:all})
      # seed 2: choice({WhiteNoise0000:all})
      # seed 3: choice({RandWalk0000:all})
      # seed 4: choice({VanDerPol0000:all})

submodule:

  model:
    # Build model from scratch
    type: NeuralTransformer 
    hidden_size: 262

  train:
    # Train model
    epochs: 500

  dataset:
    # This gets overwritten by the sweeper
    use_these_datasets:
      path: null
      num_worms: null

    save_datasets: false

    experimental_datasets:
      # This gets overwritten by the sweeper
      Sines0000: null
      Lorenz0000: null
      WhiteNoise0000: null
      RandWalk0000: null
      VanDerPol0000: null

    num_named_neurons: null
    num_train_samples: 32
    num_val_samples: 16
    seq_len: 100
    reverse: false
    use_residual: false
    smooth_data: true

  predict:
    # This gets overwritten by the sweeper
    experimental_datasets:
      Sines0000: null
      Lorenz0000: null
      WhiteNoise0000: null
      RandWalk0000: null
      VanDerPol0000: null
    # Number of time steps to generate
    nb_ts_to_generate: null
    context_window: 100

  analysis:
    analyse_this_log_dir: null
    validation:
      # This gets overwritten by the sweeper
      experimental_datasets:
        Sines0000: null
        Lorenz0000: null
        WhiteNoise0000: null
        RandWalk0000: null
        VanDerPol0000: null

experiment: 
  # What parameter you are experimenting with (key)
  key: num_time_steps 
  name: nts_transformer_synthetic
  mode: MULTIRUN