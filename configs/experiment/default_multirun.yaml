# @package _global_
defaults:
  - override /submodule: [preprocess, dataset, model, train, predict, analysis, visualize]
  - _self_

hydra:
  # The sweeper params will be used only when MULTIRUN mode is used.
  # Uses the submodule parameters if in RUN mode.
  mode: MULTIRUN
  sweeper:
      params:
        experiment.seed: range(1) # assign each repetition of the experiment a different seed
        submodule.model.type: LinearRegression, FeatureFFNN #, NetworkLSTM, NetworkCTRNN, NeuralTransformer # LiquidCfC

# The submodule parameters set below will be used only if RUN mode is used. 
# Otherwise, it uses the default parameters imported from the other config files in the submodule directory.
submodule:

  dataset:
    # Make the train and validation dataset from scratch
    use_these_datasets:
      path: null # options: null, data/datasets/<DatasetFolder>
      num_worms: null # options: null,  <int>

    save_datasets: false

    experimental_datasets:
      Sines0000: null
      Lorenz0000: null
      WhiteNoise0000: null
      RandWalk0000: null
      VanDerPol0000: null
      Kato2015: null
      Nichols2017: null
      Skora2018: null
      Kaplan2020: null
      Yemini2021: null
      Uzel2022: null
      Flavell2023: null
      Leifer2023: all

    num_named_neurons: null
    num_train_samples: 64
    num_val_samples: 32
    # Set to the same value as submodule.predict.context_window
    seq_len: 100
    reverse: false
    use_residual: false
    smooth_data: true
    train_split_first: true
    train_split_ratio: 0.5

  # Build model from scratch
  model:
    input_size: 302
    hidden_size: 256
    loss: MSE
    fft_reg_param: 0.0
    l1_reg_param: 0.0
    use_this_pretrained_model: null

  # Train model
  train:
    optimizer: AdamW
    lr: 0.001
    epochs: 1000 
    save_freq: 500
    batch_size: 128
    shuffle: true
    reverse: false
    early_stopping:
      delta: 0
      patience: 100

  predict:
    # Choose the worms that you want to predict 
    experimental_datasets:
      Sines0000: null
      Lorenz0000: null
      WhiteNoise0000: null
      RandWalk0000: null
      VanDerPol0000: null
      Kato2015: null
      Nichols2017: null
      Skora2018: null
      Kaplan2020: null
      Yemini2021: null
      Uzel2022: null
      Flavell2023: null
      Leifer2023: worm0
    # Number of time steps to generate 
    # null = generate all remaining time steps (max_timesteps - context_window)
    nb_ts_to_generate: null 
    # Set to the same value as submodule.dataset.seq_len
    context_window: 100

  analysis:
    analyse_this_log_dir: null
    # Validate final model using some/all worms from each dataset
    validation:
      # null = don't analyze on this dataset
      # all = analyze all the worms in the dataset
      # <int> = use this number of (randomly picked) worms from the dataset
      # <str> = analyze the worm with this particular wormID 
      # <list> = analyze the worms with wormIDs in the list
      experimental_datasets:
        Sines0000: null
        Lorenz0000: null
        WhiteNoise0000: null
        RandWalk0000: null
        VanDerPol0000: null
        Kato2015: null
        Nichols2017: null
        Skora2018: null
        Kaplan2020: null
        Yemini2021: null
        Uzel2022: null
        Flavell2023: null
        Leifer2023: all

  visualize:
    plot_this_log_dir: null
    predict:
      worms_to_plot: null
      neurons_to_plot: 3

experiment:
  # What parameter you are experimenting with (key)
  # Options: num_worms, num_time_steps, num_named_neurons, time_steps_per_neuron,
  #          num_samples, hidden_size, batch_size, seq_len, learn_rate, dataset,
  #          dataset, model, optimizer, loss, experiment_seed,
  #          time_last_epoch, num_parameters, computation_flops,
  key: model_type
  name: default_multirun
  mode: MULTIRUN
