# @package _global_
# nts = number of time steps
# We increase gradually the quantity of worms from all datasets.
defaults:
  - override /submodule: [preprocess, dataset, model, train, predict, analysis, visualize]
  - _self_

hydra:
  mode: MULTIRUN
  sweeper:
    params:
      experiment.seed: 0 # number of repetitions for this experiment
      submodule.dataset.experimental_datasets: choice({RandWalk0000:5},{RandWalk0000:6}) # test
      ### Synthetic datasets ###
      # choice({RandWalk0000:1},{RandWalk0000:2},{RandWalk0000:3},{RandWalk0000:4},{RandWalk0000:5},{RandWalk0000:6})
      # choice({Sines0000:1},{Sines0000:2},{Sines0000:3},{Sines0000:4},{Sines0000:5},{Sines0000:6})
      # choice({Lorenz0000:1},{Lorenz0000:2},{Lorenz0000:3},{Lorenz0000:4},{Lorenz0000:5},{Lorenz0000:6})
      # choice({VanDerPol0000:1},{VanDerPol0000:2},{VanDerPol0000:3},{VanDerPol0000:4},{VanDerPol0000:5},{VanDerPol0000:6})     
      ############################
      ### Experimental datasets ###
      ############################


submodule:

  dataset:
    # Dataset directory should contain a validation dataset
    use_these_datasets:
      path: null #data/datasets/<DatasetFolder>
      num_worms: null

    save_datasets: false

    num_named_neurons: null
    num_train_samples: 32
    num_val_samples: 16
    seq_len: 200
    reverse: false
    use_residual: false
    smooth_data: true

  model:
    # Train model from scratch
    type: LinearNN
    input_size: 302
    hidden_size: 512
    loss: MSE
    fft_reg_param: 0.0
    l1_reg_param: 0.0
    use_this_pretrained_model: null

  train:
    optimizer: AdamW
    lr: 0.001
    epochs: 100
    save_freq: 100
    batch_size: 64
    shuffle: true
    early_stopping:
      # Minimum change in validation loss to be considered an improvement
      delta: 0
      # Number of epochs to wait for improvement before stopping
      patience: 50

  predict:
    # Choose the worms that you want to predict
    experimental_datasets:
      # Sines0000: worm0
      # Lorenz0000: worm0
      # VanDerPol0000: worm0
      RandWalk0000: worm0
      # Kato2015: worm0
      # Nichols2017: worm0
      # Skora2018: worm0
      # Uzel2022: worm0
      # Yemini2021: worm0
      # Kaplan2020: worm0
      # Flavell2023: worm0
      # Leifer2023: worm0
    # Number of time steps to generate
    nb_ts_to_generate: null
    context_window: 200

  analysis:
    analyse_this_log_dir: null
    # Validate using all worms of each experimental datasets
    validation:
      experimental_datasets:
        # Sines0000: 5
        # Lorenz0000: 5
        # VanDerPol0000: 5
        RandWalk0000: 5
        # Kato2015: 5
        # Nichols2017: 5
        # Skora2018: 5
        # Uzel2022: 5
        # Yemini2021: 5
        # Kaplan2020: 5
        # Flavell2023: 5
        # Leifer2023: 5

  visualize:
    plot_figures_from_this_log_dir: null
    predict:
      worms_to_plot: null # number of worms to plot
      neurons_to_plot: 3 # number of neurons to plot

experiment: 
  key: nts_linear # what parameter you are experimenting with
  name: nts_linear
  mode: MULTIRUN